<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Username - Coolbrador</title>
    <link rel="stylesheet" href="/styles.css">
    <style>
        .profile-container { max-width: 800px; margin: 40px auto; padding: 30px; background: #1a1a1a; border-radius: 12px; color: #fff; font-family: Arial, sans-serif; }
        .profile-header { display: flex; align-items: center; gap: 25px; margin-bottom: 30px; }
        .profile-avatar { width: 160px; height: 160px; border-radius: 50%; border: 5px solid #0099ff; object-fit: cover; }
        .profile-info h1 { margin: 0; font-size: 2.8em; color: #0099ff; }
        .profile-info p { margin: 8px 0; color: #ccc; font-size: 1.1em; }
        .profile-stats { display: flex; gap: 40px; margin: 30px 0; }
        .stat { text-align: center; background: #111; padding: 15px; border-radius: 10px; flex: 1; }
        .stat-number { font-size: 2.5em; font-weight: bold; color: #0099ff; margin: 0; }
        .stat-label { color: #aaa; margin-top: 5px; }
        hr { border: 1px solid #333; margin: 30px 0; }
        h2 { color: #0099ff; }
        #bio { background: #111; padding: 15px; border-radius: 8px; min-height: 60px; }
        .profile-footer {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #333;
            display: flex;
            justify-content: space-between;
            color: #888;
            font-size: 0.95em;
        }
    </style>
</head>
<body>
    <div id="shared-header"></div>
    <div class="profile-container container">
        <div class="profile-header">
            <img id="avatar" alt="Avatar" class="profile-avatar">
            <div class="profile-info">
                <h1>Username</h1>
                <p>Country</p>
            </div>
        </div>
        <div class="profile-stats">
            <div class="stat"><div class="stat-number">0</div><div class="stat-label">Followers</div></div>
            <div class="stat"><div class="stat-number">0</div><div class="stat-label">Following</div></div>
            <div class="stat"><div class="stat-number">0</div><div class="stat-label">Posts</div></div>
        </div>
        <hr>
        <h2>About</h2>
        <p id="bio">This is the test description</p>
        <div class="profile-footer">
            <div>Joined <span id="joinDate">July 26, 2007</span></div>
            <div><span id="yeahCount">0</span> Yeahs</div>
        </div>
    </div>
    <div id="shared-footer"></div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    // Load header and footer
    fetch("/shared/header.html")
        .then(r => r.text())
        .then(html => {
            document.getElementById("shared-header").innerHTML = html;

            // Update logged-in user in header (username + correct avatar)
            const userSection = document.getElementById("userSection");
            const loggedIn = localStorage.getItem("loggedIn") === "true";
            const currentUserId = localStorage.getItem("currentUserId");

            if (loggedIn && currentUserId && userSection) {
                const userData = JSON.parse(localStorage.getItem(`user_${currentUserId}`) || "{}");
                if (userData?.username) {
                    userSection.innerHTML = `
                        <span class="username">${userData.username}</span>
                        <a href="/users/${currentUserId}/profile.html" class="user-avatar">
                            <img src="/users/${currentUserId}/pfp.jpg" alt="${userData.username}'s avatar">
                        </a>
                    `;
                    const headerImg = userSection.querySelector(".user-avatar img");
                    headerImg.onerror = () => headerImg.src = "/users/default/pfp.jpg";
                }
            } else if (userSection) {
                userSection.innerHTML = `<a href="/login.html" style="color:#007bff;font-weight:bold;text-decoration:none;">Create an account today!</a>`;
            }
        });

    fetch("/shared/footer.html")
        .then(r => r.text())
        .then(f => document.getElementById("shared-footer").innerHTML = f);

    // Load profile page avatar
    const userId = window.location.pathname.match(/\/users\/(\d+)\//)?.[1] || "1";
    const avatar = document.getElementById("avatar");
    avatar.src = `/users/${userId}/pfp.jpg`;
    avatar.onerror = () => avatar.src = "/users/default/pfp.jpg";
});
</script>
</body>
</html>
